{"ast":null,"code":"import _slicedToArray from\"/home/luismelo/Documents/GitHub/Frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Routes,Route,Navigate,useNavigate}from'react-router-dom';import{LandingPage}from'../pages/LandingPage/LandingPage';import LayoutRoutes from'../shared/components/LayoutRoutes/LayoutRotes';import Unauthorized from'../pages/Unauthorized/Unauthorized';import{Suspense,lazy,useEffect,useState}from'react';import RequireAuth from'../shared/features/RequireAuth';import axios from'../interceptors/axios';import{Loading}from'../shared/components/Loading/Loading';import{MyPageRoute}from'../shared/components/MyPageRoute/MyPageRoute';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AppRoutes=function AppRoutes(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),signedUser=_useState2[0],setSignedUser=_useState2[1];var navigate=useNavigate();var MyPage=/*#__PURE__*/lazy(function(){return import('../pages/MyPage/MyPage').then(function(_ref){var MyPage=_ref.MyPage;return{default:MyPage};});});var SignPage=/*#__PURE__*/lazy(function(){return import('../pages/SignPage/SignPage').then(function(_ref2){var SignPage=_ref2.SignPage;return{default:SignPage};});});useEffect(function(){var isAuthenticated=localStorage.getItem('isAuthenticated');if(isAuthenticated){axios.get('auth/whoami',{headers:{'Content-Type':'application/json'},withCredentials:true}).then(function(res){console.log(res.data);var signUser=res.data;if(signUser){setSignedUser(true);navigate('/my',{replace:true});}if(!signUser)navigate('/',{replace:true});}).catch(function(error){console.log(error);});}},[]);return/*#__PURE__*/_jsx(Routes,{children:/*#__PURE__*/_jsxs(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LayoutRoutes,{}),children:[!signedUser?/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(Loading,{}),children:/*#__PURE__*/_jsx(LandingPage,{})})}):/*#__PURE__*/_jsx(Route,{path:\"/my\",element:/*#__PURE__*/_jsx(MyPageRoute,{})}),!signedUser?/*#__PURE__*/_jsx(Route,{path:\"/sign\",element:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(Loading,{}),children:/*#__PURE__*/_jsx(SignPage,{})})}):/*#__PURE__*/_jsx(Route,{path:\"/my\",element:/*#__PURE__*/_jsx(MyPageRoute,{})}),!signedUser?/*#__PURE__*/_jsx(Route,{path:\"/unauthorized\",element:/*#__PURE__*/_jsx(Unauthorized,{})}):/*#__PURE__*/_jsx(Route,{path:\"/my\",element:/*#__PURE__*/_jsx(MyPageRoute,{})}),/*#__PURE__*/_jsx(Route,{element:/*#__PURE__*/_jsx(RequireAuth,{allowedRoles:['admin','student','professor']}),children:/*#__PURE__*/_jsx(Route,{path:\"/my\",element:/*#__PURE__*/_jsx(MyPageRoute,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})});};","map":{"version":3,"names":["Routes","Route","Navigate","useNavigate","LandingPage","LayoutRoutes","Unauthorized","Suspense","lazy","useEffect","useState","RequireAuth","axios","Loading","MyPageRoute","AppRoutes","signedUser","setSignedUser","navigate","MyPage","then","default","SignPage","isAuthenticated","localStorage","getItem","get","headers","withCredentials","res","console","log","data","signUser","replace","catch","error"],"sources":["/home/luismelo/Documents/GitHub/Frontend/src/routes/index.tsx"],"sourcesContent":["import { Routes, Route, Navigate, useNavigate } from 'react-router-dom';\nimport { LandingPage } from '../pages/LandingPage/LandingPage';\nimport LayoutRoutes from '../shared/components/LayoutRoutes/LayoutRotes';\nimport Unauthorized from '../pages/Unauthorized/Unauthorized';\nimport { Suspense, lazy, useEffect, useState } from 'react';\nimport RequireAuth from '../shared/features/RequireAuth';\nimport axios from '../interceptors/axios';\nimport { Loading } from '../shared/components/Loading/Loading';\nimport { MyPageRoute } from '../shared/components/MyPageRoute/MyPageRoute';\nexport const AppRoutes = () => {\n  const [signedUser, setSignedUser] = useState(false);\n  const navigate = useNavigate();\n  const MyPage = lazy(() =>\n    import('../pages/MyPage/MyPage').then(({ MyPage }) => ({ default: MyPage }))\n  );\n  const SignPage = lazy(() =>\n    import('../pages/SignPage/SignPage').then(({ SignPage }) => ({\n      default: SignPage,\n    }))\n  );\n\n  useEffect(() => {\n    const isAuthenticated = localStorage.getItem('isAuthenticated');\n    if (isAuthenticated) {\n      axios\n        .get('auth/whoami', {\n          headers: { 'Content-Type': 'application/json' },\n          withCredentials: true,\n        })\n        .then((res) => {\n          console.log(res.data);\n          const signUser = res.data;\n\n          if (signUser) {\n            setSignedUser(true);\n            navigate('/my', { replace: true });\n          }\n          if (!signUser) navigate('/', { replace: true });\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    }\n  }, []);\n\n  return (\n    <Routes>\n      <Route path=\"/\" element={<LayoutRoutes />}>\n        {/* public routes */}\n        {!signedUser ? (\n          <Route\n            path=\"/\"\n            element={\n              <Suspense fallback={<Loading />}>\n                <LandingPage />\n              </Suspense>\n            }\n          />\n        ) : (\n          <Route path=\"/my\" element={<MyPageRoute />} />\n        )}\n        {!signedUser ? (\n          <Route\n            path=\"/sign\"\n            element={\n              <Suspense fallback={<Loading />}>\n                <SignPage />\n              </Suspense>\n            }\n          />\n        ) : (\n          <Route path=\"/my\" element={<MyPageRoute />} />\n        )}\n        {!signedUser ? (\n          <Route path=\"/unauthorized\" element={<Unauthorized />} />\n        ) : (\n          <Route path=\"/my\" element={<MyPageRoute />} />\n        )}\n\n        {/*  private routes */}\n        {/*Separate Protected Nested Routes with every role. For now Admin, Student and Professor are allowed */}\n\n        <Route\n          element={\n            <RequireAuth allowedRoles={['admin', 'student', 'professor']} />\n          }\n        >\n          <Route path=\"/my\" element={<MyPageRoute />} />\n        </Route>\n\n        {/* catch all */}\n        <Route path=\"*\" element={<Navigate to=\"/\" />} />\n      </Route>\n    </Routes>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}